--- libstdio/fflush.c   21 Sep 2005 07:33:08 -0000      1.19
+++ libstdio/fflush.c   9 May 2006 11:06:19 -0000
@@ -17,10 +17,10 @@
   if (stream==0) {
     int res;
     FILE *f;
-    __fflush_stdin();
     __fflush_stdout();
     __fflush_stderr();
     for (res=0, f=__stdio_root; f; f=f->next)
+      if (!f->flags&BUFINPUT)
       if (fflush(f))
        res=-1;
     return res;
